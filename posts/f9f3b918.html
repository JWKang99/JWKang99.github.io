<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>设计模式简单实现(创建型) | 解忧杂货铺</title><meta name="description" content="设计模式简单实现(创建型)"><meta name="keywords" content="java,设计模式"><meta name="author" content="康宁"><meta name="copyright" content="康宁"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/008-typing.png"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="设计模式简单实现(创建型)"><meta name="twitter:description" content="设计模式简单实现(创建型)"><meta name="twitter:image" content="https://jwkang99.github.io/img/设计模式.jpg"><meta property="og:type" content="article"><meta property="og:title" content="设计模式简单实现(创建型)"><meta property="og:url" content="https://jwkang99.github.io/posts/f9f3b918"><meta property="og:site_name" content="解忧杂货铺"><meta property="og:description" content="设计模式简单实现(创建型)"><meta property="og:image" content="https://jwkang99.github.io/img/设计模式.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://jwkang99.github.io/posts/f9f3b918"><link rel="prev" title="剑指offer算法答案(java)" href="https://jwkang99.github.io/posts/30d88c90.html"><link rel="next" title="设计模式简单实现(结构型)" href="https://jwkang99.github.io/posts/41c70678.html"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="解忧杂货铺" type="application/atom+xml">
</head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">解忧杂货铺</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar1.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">40</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">24</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">15</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#设计模式及简单实现"><span class="toc_mobile_items-text">设计模式及简单实现</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-创建型模式"><span class="toc_mobile_items-text">1 创建型模式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-1-单例模式"><span class="toc_mobile_items-text">1.1 单例模式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-1-1-饿汉式（静态常量）"><span class="toc_mobile_items-text">1.1.1 饿汉式（静态常量）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-1-2-饿汉式（静态代码块）"><span class="toc_mobile_items-text">1.1.2 饿汉式（静态代码块）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-1-3-懒汉式（线程不安全）"><span class="toc_mobile_items-text">1.1.3 懒汉式（线程不安全）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-1-4-懒汉式（线程安全，同步方法）"><span class="toc_mobile_items-text">1.1.4 懒汉式（线程安全，同步方法）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-1-5-懒汉式（同步代码块）"><span class="toc_mobile_items-text">1.1.5 懒汉式（同步代码块）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-1-6-双重检查"><span class="toc_mobile_items-text">1.1.6 双重检查</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-1-7-静态内部类"><span class="toc_mobile_items-text">1.1.7 静态内部类</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-1-8-枚举"><span class="toc_mobile_items-text">1.1.8 枚举</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-2-工厂模式"><span class="toc_mobile_items-text">1.2 工厂模式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-1-简单工厂模式"><span class="toc_mobile_items-text">1.2.1 简单工厂模式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-2-工厂方法模式"><span class="toc_mobile_items-text">1.2.2 工厂方法模式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-3-抽象工厂模式"><span class="toc_mobile_items-text">1.2.3 抽象工厂模式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#注：简单工厂vs工厂方法vs抽象工厂"><span class="toc_mobile_items-text">注：简单工厂vs工厂方法vs抽象工厂</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-4-用简单工厂改进抽象工厂"><span class="toc_mobile_items-text">1.2.4 用简单工厂改进抽象工厂</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-5-利用反射改进抽象工厂"><span class="toc_mobile_items-text">1.2.5 利用反射改进抽象工厂</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-3-原型模式"><span class="toc_mobile_items-text">1.3 原型模式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#浅拷贝与深拷贝"><span class="toc_mobile_items-text">浅拷贝与深拷贝</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-4-建造者模式"><span class="toc_mobile_items-text">1.4 建造者模式</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#设计模式及简单实现"><span class="toc-text">设计模式及简单实现</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-创建型模式"><span class="toc-text">1 创建型模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-单例模式"><span class="toc-text">1.1 单例模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-饿汉式（静态常量）"><span class="toc-text">1.1.1 饿汉式（静态常量）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-饿汉式（静态代码块）"><span class="toc-text">1.1.2 饿汉式（静态代码块）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-3-懒汉式（线程不安全）"><span class="toc-text">1.1.3 懒汉式（线程不安全）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-4-懒汉式（线程安全，同步方法）"><span class="toc-text">1.1.4 懒汉式（线程安全，同步方法）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-5-懒汉式（同步代码块）"><span class="toc-text">1.1.5 懒汉式（同步代码块）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-6-双重检查"><span class="toc-text">1.1.6 双重检查</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-7-静态内部类"><span class="toc-text">1.1.7 静态内部类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-8-枚举"><span class="toc-text">1.1.8 枚举</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-工厂模式"><span class="toc-text">1.2 工厂模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-简单工厂模式"><span class="toc-text">1.2.1 简单工厂模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-工厂方法模式"><span class="toc-text">1.2.2 工厂方法模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-3-抽象工厂模式"><span class="toc-text">1.2.3 抽象工厂模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#注：简单工厂vs工厂方法vs抽象工厂"><span class="toc-text">注：简单工厂vs工厂方法vs抽象工厂</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-4-用简单工厂改进抽象工厂"><span class="toc-text">1.2.4 用简单工厂改进抽象工厂</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-5-利用反射改进抽象工厂"><span class="toc-text">1.2.5 利用反射改进抽象工厂</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-原型模式"><span class="toc-text">1.3 原型模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#浅拷贝与深拷贝"><span class="toc-text">浅拷贝与深拷贝</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-建造者模式"><span class="toc-text">1.4 建造者模式</span></a></li></ol></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(/img/设计模式.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">设计模式简单实现(创建型)</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2019-11-16<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-03-26</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">基础知识</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="设计模式及简单实现"><a href="#设计模式及简单实现" class="headerlink" title="设计模式及简单实现"></a>设计模式及简单实现</h1><p>根据模式是用来完成什么工作来划分，设计模式分为三种类型，共23种。</p>
<p>①<strong>创建型模式</strong>（5种）：<span style="color:red">单例模式</span>、抽象工厂模式、原型模式、建造者模式、<span style="color:red">工厂方法模式</span>。</p>
<p>②<strong>结构型模式</strong>（7种）：适配器模式、桥接模式、<span style="color:red">装饰模式</span>、组合模式、外观模式、享元模式、<span style="color:red">代理模式</span>。</p>
<p>③<strong>行为型模式</strong>（11种）：模板方法模式、命令模式、访问者模式、迭代器模式、<span style="color:red">观察者模式</span>、中介者模式、备忘录模式、解释器模式（Interpreter模式）、状态模式、策略模式、职责模式（责任链模式）。</p>
<h2 id="1-创建型模式"><a href="#1-创建型模式" class="headerlink" title="1 创建型模式"></a>1 创建型模式</h2><p>重点强调的是对象创建的时候怎么设计代码，它的主要特点是将对象的创建与使用分离开来。创建型模式包括以下几种：<span style="color:red">单例模式</span>、抽象工厂模式、原型模式、建造者模式、<span style="color:red">工厂模式</span>。</p>
<h3 id="1-1-单例模式"><a href="#1-1-单例模式" class="headerlink" title="1.1 单例模式"></a>1.1 单例模式</h3><p>单例模式保证一个类只有一个实例对象，并提供一个访问它的全局访问点。</p>
<p>使用场景：需要频繁的进行创建和销毁的对象，创建对象时耗时过多或耗费资源过多（即重量级对象），但又经常用到的对象、工具类对象、频繁访问数据库或文件的对象（比如数据源、session工厂等）。</p>
<p>单例模式共有以下几种方式。</p>
<h4 id="1-1-1-饿汉式（静态常量）"><a href="#1-1-1-饿汉式（静态常量）" class="headerlink" title="1.1.1 饿汉式（静态常量）"></a>1.1.1 饿汉式（静态常量）</h4><p>优点：写法简单，在类装载的时候完成实例化。<strong>避免了线程同步问题</strong>。</p>
<p>缺点：在类装载的时候完成实例化，没有达到懒加载的效果。如果从未使用这个实例，则会浪费内存。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//此单例模式可用，但会浪费内存</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton_1</span> </span>&#123;</span><br><span class="line">    <span class="comment">//构造器私有，外部不能new</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton_1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Singleton_1 instance = <span class="keyword">new</span> Singleton_1();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Singleton_1 <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="1-1-2-饿汉式（静态代码块）"><a href="#1-1-2-饿汉式（静态代码块）" class="headerlink" title="1.1.2 饿汉式（静态代码块）"></a>1.1.2 饿汉式（静态代码块）</h4><p>和上一实现方式类似，优缺点一致。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton_2</span> </span>&#123;</span><br><span class="line">    <span class="comment">//构造器私有，外部不能new</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton_2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton_2 instance;</span><br><span class="line">    <span class="keyword">static</span> &#123; <span class="comment">//在静态代码块中创建实例对象</span></span><br><span class="line">        instance = <span class="keyword">new</span> Singleton_2()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Singleton_2 <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="1-1-3-懒汉式（线程不安全）"><a href="#1-1-3-懒汉式（线程不安全）" class="headerlink" title="1.1.3 懒汉式（线程不安全）"></a>1.1.3 懒汉式（线程不安全）</h4><p>优点：起到了懒加载的效果，用到额才会加载。</p>
<p>缺点：只能在单线程下使用，线程不安全。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实际开发中不使用，多线程不可用</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton_3</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton_3 instance;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton_3</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton_3 <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//用到才加载</span></span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton_3();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="1-1-4-懒汉式（线程安全，同步方法）"><a href="#1-1-4-懒汉式（线程安全，同步方法）" class="headerlink" title="1.1.4 懒汉式（线程安全，同步方法）"></a>1.1.4 懒汉式（线程安全，同步方法）</h4><p>优点：解决了线程不安全问题</p>
<p>缺点：效率太低了，每个线程想要获取实例时，都要进行同步。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//不推荐使用，多线程可用，但效率太低</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton_4</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton_4 instance;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton_4</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="comment">//加上synchronized关键字，加入同步机制</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton_4 <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton_4();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="1-1-5-懒汉式（同步代码块）"><a href="#1-1-5-懒汉式（同步代码块）" class="headerlink" title="1.1.5 懒汉式（同步代码块）"></a>1.1.5 懒汉式（同步代码块）</h4><p><strong>这种方式不可取</strong>，本意时想要对第四种方式的效率问题进行改进，实际仍会产生多个实例。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//不能实现线程安全，多线程不可用</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton_5</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton_5 instance;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton5</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton_5 <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="comment">//仍会有多个线程进入if创建实例对象</span></span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton_8<span class="class">.<span class="keyword">class</span>)</span>&#123;</span><br><span class="line">                instance = <span class="keyword">new</span> Singleton_5();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="1-1-6-双重检查"><a href="#1-1-6-双重检查" class="headerlink" title="1.1.6 双重检查"></a>1.1.6 双重检查</h4><p>优点：保证了线程安全的情况下，实现了懒加载，避免反复进行方法同步，也保证了多线程下的效率。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//推荐使用</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton_6</span> </span>&#123;</span><br><span class="line">    <span class="comment">//volatile保证instance可见性，禁止指令重排</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton_6 instance;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton_6</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="comment">//doube check</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton_6 <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton_6<span class="class">.<span class="keyword">class</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> Singleton_6();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="1-1-7-静态内部类"><a href="#1-1-7-静态内部类" class="headerlink" title="1.1.7 静态内部类"></a>1.1.7 静态内部类</h4><p>静态内部类特点</p>
<ul>
<li>外部类装载的时候内部类不会被装载</li>
<li>在调用的时候装载内部类，并且线程安全</li>
</ul>
<p>优点：</p>
<ul>
<li>这种方式利用了类装载的机制来保证初始化实例时只有一个线程。</li>
<li>静态内部类方式Singleton_7类被装载时并不会立即实例化，二十在需要实例化时调用getInstance方法，才会装载SingletonInstance类，从而完成Singleton_7的实例化。</li>
<li>类的静态属只会在第一次加载在类的时候初始化，所以JVM帮助我们保证了线程的安全性，在类进行初始化时，别的线程是无法进入的。</li>
<li>总的来说优点，线程安全，利用静态内部类特点实现了加载延迟，效率高</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//线程安全，效率高推荐使用</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton_7</span> </span>&#123;</span><br><span class="line">    <span class="comment">//构造私有</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton_7</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="comment">//静态内部类，该类中有一个静态属性Singleton</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonInstance</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton_7 INSTANCE = <span class="keyword">new</span> Singleton_7();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//提供一个静态的共有方法，直接返回SingletonInstance.INSTANCE</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton_7 <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonInstance.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="1-1-8-枚举"><a href="#1-1-8-枚举" class="headerlink" title="1.1.8 枚举"></a>1.1.8 枚举</h4><p>借助JDK1.5中添加的枚举来实现单例。不仅能够<strong>避免多线程同步问题</strong>，还能防止反序列化重新创建新的对象。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//线程安全，推荐使用</span></span><br><span class="line"><span class="keyword">enum</span> Singleton_8 &#123;</span><br><span class="line">    INSTANCE;</span><br><span class="line">    <span class="comment">//enum的构造函数只支持private </span></span><br><span class="line">    <span class="comment">//而且因为所有枚举都继承自java.lang.Enum类 </span></span><br><span class="line">    <span class="comment">//因此枚举不能再继承其他类 但是可以实现接口</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton_8</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"单例运行"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="1-2-工厂模式"><a href="#1-2-工厂模式" class="headerlink" title="1.2 工厂模式"></a>1.2 工厂模式</h3><h4 id="1-2-1-简单工厂模式"><a href="#1-2-1-简单工厂模式" class="headerlink" title="1.2.1 简单工厂模式"></a>1.2.1 简单工厂模式</h4><p>简单工厂模式是工厂模式的一种，是由一个工厂对象决定创建出哪一种产品类的实例，是工厂模式家族最简单实用的模式。</p>
<p>简单的说：简单工厂模式定义了一个创建对象的类，由这个类来<strong>封装实例化对象</strong>的行为（代码）。</p>
<p>使用场景：当我们会大量创建某种、某类或者某批对象是，就会使用到工厂模式。</p>
<p>在以下简单工厂的例子中，如果没有工厂类，Store类直接接管所有车类，当有新车型C时，所有Store就都需要修改。增加工厂类，Store只负责从工厂类中拿到相应的车型，不关心车如何生产。当增加车型只需要修改工厂类的代码即可，所有store类都不需要修改。（工厂类也可使用单例或者静态方法）</p>
<p>优点：不需要修改客户端代码（Store类）</p>
<p>缺点：当需要增加新的Car类时，不仅需新Car类代码，还要修改工厂类。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//车接口</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ICar</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getInfo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//A车</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ACar</span> <span class="keyword">implements</span> <span class="title">ICar</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是A车"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//B车</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BCar</span> <span class="keyword">implements</span> <span class="title">ICar</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是B车"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//简单工厂</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ICar <span class="title">createCar</span><span class="params">(String type)</span></span>&#123;</span><br><span class="line">        ICar iCar = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(type.equals(<span class="string">"A"</span>))&#123;</span><br><span class="line">            iCar = <span class="keyword">new</span> ACar();</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(type.equals(<span class="string">"B"</span>))&#123;</span><br><span class="line">            iCar = <span class="keyword">new</span> BCar();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> iCar;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//车店1</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CarStore1</span> </span>&#123;</span><br><span class="line">    <span class="comment">//简单工厂模式中，本例中</span></span><br><span class="line">    <span class="comment">//客户端需要知道两个类SimpleFactory和ICar</span></span><br><span class="line">    SimpleFactory factory = <span class="keyword">new</span> SimpleFactory();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sellCar</span><span class="params">(String type)</span></span>&#123;</span><br><span class="line">        ICar car = factory.createCar(type);</span><br><span class="line">        <span class="keyword">if</span>(car==<span class="keyword">null</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">"买车失败"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            car.getInfo();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="1-2-2-工厂方法模式"><a href="#1-2-2-工厂方法模式" class="headerlink" title="1.2.2 工厂方法模式"></a>1.2.2 工厂方法模式</h4><p>工厂方法模式定义了一个用于创建对象的接口，让子类决定实例化哪一个类。工厂方法使一个类的实例化延迟到其子类。</p>
<p>工厂方法模式与简单工厂有所区别，简单工厂模式只有一个工厂，工厂方法模式的每一中产品都有一个工厂，抽象出一个核心工厂类。</p>
<p>优点：当有新增Car类型时，只需增加对应的Car类和工厂类。</p>
<p>缺点：会修改客户端代码，工厂方法模式将简单工厂的内部判断逻辑移到了客户端内进行，增加了用户操作的复杂性。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//车接口</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ICar</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getInfo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//A车</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ACar</span> <span class="keyword">implements</span> <span class="title">ICar</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是A车"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//B车</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BCar</span> <span class="keyword">implements</span> <span class="title">ICar</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是B车"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//工厂接口</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IFactory</span> </span>&#123;</span><br><span class="line">    <span class="function">ICar <span class="title">createCar</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//A车工厂</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ACarFactory</span> <span class="keyword">implements</span> <span class="title">IFactory</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ICar <span class="title">createCar</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ACar();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//B车接口</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BCarFactory</span> <span class="keyword">implements</span> <span class="title">IFactory</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ICar <span class="title">createCar</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> BCar();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//车店1</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CarStore1</span> </span>&#123;</span><br><span class="line">    IFactory aFactory = <span class="keyword">new</span> ACarFactory();</span><br><span class="line">    IFactory bFactory = <span class="keyword">new</span> BCarFactory();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sellCar</span><span class="params">(String type)</span></span>&#123;</span><br><span class="line">        ICar car = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(type.equals(<span class="string">"A"</span>))&#123;</span><br><span class="line">            car = aFactory.createCar();</span><br><span class="line">            car.getInfo();</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(type.equals(<span class="string">"B"</span>))&#123;</span><br><span class="line">            car = bFactory.createCar();</span><br><span class="line">            car.getInfo();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">"买车失败"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="1-2-3-抽象工厂模式"><a href="#1-2-3-抽象工厂模式" class="headerlink" title="1.2.3 抽象工厂模式"></a>1.2.3 抽象工厂模式</h4><p>抽象工厂模式可以将简单工厂模式和工厂方法模式整合，将一组有共同特征的产品（产品族）放在同一工厂内生产。</p>
<p><strong>提供一个创建一系列相关或相互依赖对象的接口</strong>，而无需指定他们具体的类。我们有两个产品族，保证同一种工厂只能生产对应的产品。当需要创建的对象是一系列相互关联或相互依赖的产品族时，便可以使用抽象工厂模式。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//车接口</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ICar</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getInfo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//自行车接口</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IBike</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getInfo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//A车</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ACar</span> <span class="keyword">implements</span> <span class="title">ICar</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是A车"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//A自行车</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ABike</span> <span class="keyword">implements</span> <span class="title">IBike</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"A自行车"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//B车</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BCar</span> <span class="keyword">implements</span> <span class="title">ICar</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我是B车"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//B自行车B</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BBike</span> <span class="keyword">implements</span> <span class="title">IBike</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"B自行车"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//工厂接口</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">IFactory</span> </span>&#123;</span><br><span class="line">    <span class="function">ICar <span class="title">createCar</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">IBike <span class="title">createBike</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//A车工厂</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AFactory</span> <span class="keyword">implements</span> <span class="title">IFactory</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ICar <span class="title">createCar</span><span class="params">(String type)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">"A"</span>.equals(type))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ACar();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBike <span class="title">createBike</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ABike();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//B车接口</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BFactory</span> <span class="keyword">implements</span> <span class="title">IFactory</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ICar <span class="title">createCar</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> BCar();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBike <span class="title">createBike</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> BBike();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span> </span>&#123;</span><br><span class="line">    <span class="comment">//只需要确定实例化哪一个品牌族给factory</span></span><br><span class="line">    IFactory factory = <span class="keyword">new</span> AFactory();</span><br><span class="line">    <span class="comment">//与具体某品牌的产品生产过程解除依赖</span></span><br><span class="line">    ICar ac = factory.createCar();</span><br><span class="line">    ac.getInfo();</span><br><span class="line">    IBike ab = factory.createBike();</span><br><span class="line">    ab.getInfo();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="注：简单工厂vs工厂方法vs抽象工厂"><a href="#注：简单工厂vs工厂方法vs抽象工厂" class="headerlink" title="注：简单工厂vs工厂方法vs抽象工厂"></a>注：简单工厂vs工厂方法vs抽象工厂</h4><p>简单工厂的最大<strong>优点</strong>在于工厂类中包含了必要的逻辑判断，根据客户端的选择条件动态实例化相关的类，对于客户端来说，去除了与具体产品的依赖。<strong>缺点</strong>在于当需要扩展时一定要在工厂类内部修改判断条件，增加判断分支，修改了原有的类，违反了开闭原则。</p>
<p>工厂方法实现时，<strong>优点</strong>在于扩展新的功能模块时完全符合开闭原则。<strong>缺点</strong>是客户端需要决定实例化哪一个工厂生产具体的产品，选择判断的问题还是存在，也就是工厂方法将简单工厂的内部逻辑判断移到了客户端，选择新加的功能则要修改客户端。</p>
<p>抽象工厂最大的<strong>优点</strong>是易于交换产品系列，由于具体工厂类在一个应用中只需要初始化的时候出现一次，这使得改变一个应用的具体工厂非常容易，只需要改变具体工厂即可使用不同的产品配置。第二个<strong>优点</strong>是让具体的创建产品实例过程与客户端分离，客户端时通过他们的抽象接口操纵实例，产品的具体类名也被具体工厂的实现分离，不会出现在客户代码中。<strong>缺点</strong>是当两个品牌都新增产品时，需要修改的类过多，<code>IFactory</code>及其实现都要修改。另外，当有多个客户端时，客户都想要更换产品族则每个客户端都要进行修改。</p>
<h4 id="1-2-4-用简单工厂改进抽象工厂"><a href="#1-2-4-用简单工厂改进抽象工厂" class="headerlink" title="1.2.4 用简单工厂改进抽象工厂"></a>1.2.4 用简单工厂改进抽象工厂</h4><p>利用简单工厂改进抽象工厂改进上述缺点，去掉众多工厂类，取而代之的是统一的<code>Provider</code>类。当新增产品时，只需在该类中增加方法即可，不需要修改众多的工厂类，并且客户端中没有出现任何与品牌相关的字样，达到了解耦的目的。但是有一个只<strong>致命缺点</strong>，当新增一个品牌时，原先在抽象工厂方法中只需增加一个工厂即可，现在就需要修改<code>Provider</code>中的条件语句。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//A和B的Car、Bike实现与上相同</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Provider</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String type=<span class="string">"A"</span>;</span><br><span class="line">    <span class="comment">//private static String type="B";</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ICar <span class="title">createCar</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ICar car = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">"A"</span>.equals(type))&#123;</span><br><span class="line">            car = <span class="keyword">new</span> ACar();</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"B"</span>.equals(type))&#123;</span><br><span class="line">            car = <span class="keyword">new</span> BCar();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> car;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IBike <span class="title">createBike</span><span class="params">()</span></span>&#123;</span><br><span class="line">        IBike bike = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">"A"</span>.equals(type))&#123;</span><br><span class="line">            bike = <span class="keyword">new</span> ABike();</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"B"</span>.equals(type))&#123;</span><br><span class="line">            bike = <span class="keyword">new</span> BBike();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bike;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//客户端</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span> </span>&#123;</span><br><span class="line">    <span class="comment">//客户端直接得到相应的产品族实例，不存在仍和依赖</span></span><br><span class="line">    ICar ac = Provider.createCar();</span><br><span class="line">    ac.getInfo();</span><br><span class="line">    IBike ab = Provider.createBike();</span><br><span class="line">    ab.getInfo();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="1-2-5-利用反射改进抽象工厂"><a href="#1-2-5-利用反射改进抽象工厂" class="headerlink" title="1.2.5 利用反射改进抽象工厂"></a>1.2.5 利用反射改进抽象工厂</h4><p>代码如下，通过type字段和反射机制，实例化相应的产品。当新增产品时只需在<code>Provide</code>中新增方法，新增品牌时，除了新增相应品牌的实体类，无需做其他修改。<strong>缺点</strong>，当需要切换品牌时仍需修改type字段。可通过配置文件的方法，从而实现不修改任何类完成产品切换，代码这里就不写了。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Provider</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String type=<span class="string">"A"</span>;</span><br><span class="line">    <span class="comment">//private static String type="B";</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ICar <span class="title">createCar</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ICar car = (ICar) Class.forName(type+<span class="string">"Car"</span>).newInstance();</span><br><span class="line">        <span class="keyword">return</span> car;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IBike <span class="title">createBike</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        IBike bike = (ICar) Class.forName(type+<span class="string">"Car"</span>).newInstance();</span><br><span class="line">        <span class="keyword">return</span> bike;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//客户端</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span> </span>&#123;</span><br><span class="line">    <span class="comment">//客户端直接得到相应的产品族实例，不存在仍和依赖</span></span><br><span class="line">    ICar ac = Provider.createCar();</span><br><span class="line">    ac.getInfo();</span><br><span class="line">    IBike ab = Provider.createBike();</span><br><span class="line">    ab.getInfo();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><strong>所有在有简单工厂的地方，都可以考虑用反射来去除switch和if语句，接触分支判断带来的耦合</strong>！</p>
<h3 id="1-3-原型模式"><a href="#1-3-原型模式" class="headerlink" title="1.3 原型模式"></a>1.3 原型模式</h3><p>原型模式（Prototype），用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。<strong>原型模式其实就是从一个对象再创建另外一个可定制的对象，而且不需要知道任何创建的细节</strong>。通过原型对象.clone()创建新的对象。</p>
<p>在克隆羊的例子中，传统方法中每克隆一只羊都要重新获取原始对象的每个属性，并且重新初始化对象，而不是动态地获得对象运行时地状态，不够灵活，如果创建地对象比较复杂，效率低。</p>
<p>原型模式结构图：</p>
<p><a href="/posts/f9f3b918/prototype.jpg" data-fancybox="group" data-caption="prototype" class="fancybox"><img alt="prototype" title="prototype" data-src="/posts/f9f3b918/prototype.jpg" class="lazyload"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据类图中的结构大致实现如下</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Prototype</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String type;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Prototype</span><span class="params">(String type)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.type = type;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getType</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.type;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Prototype <span class="title">Clone</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//具体原型类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConcretePrototypeA</span> <span class="keyword">extends</span> <span class="title">Prototype</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcretePrototypeA</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(type);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Prototype <span class="title">Clone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.Clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doClient</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ConcretePrototypeA p1 = <span class="keyword">new</span> ConcretePrototypeA(<span class="string">"AAA"</span>);</span><br><span class="line">        ConcretePrototypeA c1 = (ConcretePrototypeA)p1.Clone();</span><br><span class="line">        System.out.println(c1.getType());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><font color="red">注：</font>Java中Object类时所有类的根类，Object的方法提供了一个clone()方法，可以将Java对象复制一份，但是需要实现clone的Java类必须实现一个接口Cloneable，该接口表示该类能够复制且具有复制的能力。（这就是原型模式）</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用java中Object中的clone()实现</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sheep</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Sheep</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//使用默认的Object中的clone完成</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Sheep sheep = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            sheep= (Sheep) <span class="keyword">super</span>.clone();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sheep;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">doClient</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"TOM"</span>);</span><br><span class="line">        Sheep sheep1 = (Sheep) sheep.clone();</span><br><span class="line">        <span class="comment">//两个Sheep对象并不是同一个，也不是new出来的</span></span><br><span class="line">        System.out.println(sheep); <span class="comment">//Sheep@154617c</span></span><br><span class="line">        System.out.println(sheep1);<span class="comment">//Sheep@a14482</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>Spring中往IOC容器中注入bean可以配置为原型模式(Prototype)。（?）</p>
<h4 id="浅拷贝与深拷贝"><a href="#浅拷贝与深拷贝" class="headerlink" title="浅拷贝与深拷贝"></a>浅拷贝与深拷贝</h4><ul>
<li>浅拷贝</li>
</ul>
<p>上述例子和结构图都为浅拷贝。</p>
<p>当原型对象的成员变量是基本数据类型时，浅拷贝会直接将值传递，即复制一份给新的对象；若成员变量时引用类型时，比如某个数组或某个类的对象，那么浅拷贝会进行引用传递，即拷贝出来的副本对象的该成员属性与原型对象的属性<strong>指向同一个对象实例</strong>，在原型对象修改该成员变量时，所有对象的该属性都受到影响。浅拷贝是使用<strong>默认</strong>的clone()完成的。</p>
<ul>
<li>深拷贝</li>
</ul>
<p>与浅拷贝相对，深拷贝复制原型对象的所有基本数据类型的成员变量值。为所有引用类型的成员变量申请存储空间，并且对引用类型的成员变量也进行拷贝，那么原型对象和副本的属性指向的就不是同一个对象。<strong>深拷贝深入到多少层要视情况而定，否则会出现循环引用</strong>。</p>
<p>深拷贝实现方式：<font color="red">重写clone()</font>或者<font color="red">通过对象序列化</font>。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//深拷贝</span></span><br><span class="line"><span class="comment">//使用java中Object中的clone()实现</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sheep</span> <span class="keyword">implements</span> <span class="title">Serialiazable</span>,<span class="title">Cloneable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">public</span> Sheep wife;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Sheep</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//深拷贝方式1：重写clone完成深拷贝</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Sheep sheep = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            sheep= (Sheep) <span class="keyword">super</span>.clone();</span><br><span class="line">            sheep.wife = (Sheep)wife.clone();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sheep;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//深拷贝方式2：对象序列化实现（推荐）</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">deepClone</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//创建流对象</span></span><br><span class="line">        ByteArrayOutputStream bos = <span class="keyword">null</span>;</span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">null</span>;</span><br><span class="line">        ByteArrayInputStream bis = <span class="keyword">null</span>;</span><br><span class="line">        ObjectInputStream ois = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//序列化</span></span><br><span class="line">            bos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">            oos = <span class="keyword">new</span> ObjectOutputStream(bos);</span><br><span class="line">            <span class="comment">//以对象流的方式输出</span></span><br><span class="line">            oos.writeObject(<span class="keyword">this</span>);</span><br><span class="line">            <span class="comment">//反序列化</span></span><br><span class="line">            bis = <span class="keyword">new</span> ByteInputStream(bos.toByteArray(),bos.toByteArray().length);</span><br><span class="line">            ois = <span class="keyword">new</span> ObjectInputStream(bis);</span><br><span class="line">            Sheep copySheep = (Sheep) ois.readObject();</span><br><span class="line">            <span class="keyword">return</span> copySheep;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">//关闭流...</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="1-4-建造者模式"><a href="#1-4-建造者模式" class="headerlink" title="1.4 建造者模式"></a>1.4 建造者模式</h3><p><strong>将一个复杂对象的构建与它的表示分离</strong>，使得同样的构建过程可以创建不同的表示。用户只需要指定需要建造的类型就可以得到它们，而具体建造的过程和细节就不知道了。</p>
<p>建造者中有四个角色：<br>①Product（产品）：一个具体的产品对象<br>②Builder（抽象建造者）：创建一个Product对象的各个部件指定的接口/抽象类<br>③ConcreteBuiler（具体建造者）：实现接口，狗i教案和装配各个部件<br>④Director（指挥者）：构建一个使用Builer接口的对象，主要用于创建一个复杂的对象。作用有两个，一是隔离了客户与对象的生产过程，二是负责控制产品对象的生产过程。</p>
<p><a href="/posts/f9f3b918/builder.jpg" data-fancybox="group" data-caption="decorator" class="fancybox"><img alt="decorator" style="zoom:50%;" title="decorator" data-src="/posts/f9f3b918/builder.jpg" class="lazyload"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">House</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String basic;</span><br><span class="line">    <span class="keyword">private</span> String wall;</span><br><span class="line">    <span class="keyword">private</span> String roof;</span><br><span class="line">    ....</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//抽象的建造者</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">HouseBuilder</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> House house = <span class="keyword">new</span> House();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildBasic</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildWall</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildRoof</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//将产品返回，在buildHouse中可以组合固定建造顺序</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> House <span class="title">buildHouse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> house;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommonHouse</span> <span class="keyword">extends</span> <span class="title">HouseBuilder</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildBasic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"CommonHouse Basic"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildWall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"CommonHouse Wall"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildRoof</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"CommonHouse Roof"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpecialHouse</span> <span class="keyword">extends</span> <span class="title">HouseBuilder</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildBasic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"SpecialHouse Basic"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildWall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"SpecialHouse Wall"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildRoof</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"SpecialHouse Roof"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HouseDirector</span> </span>&#123;</span><br><span class="line">    HouseBuilder houseBuilder = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">//构造器传入</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HouseDirector</span><span class="params">(HouseBuilder houseBuilder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.houseBuilder = houseBuilder;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//具体如何建房子交给指挥者</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> House <span class="title">getHouse</span><span class="params">()</span></span>&#123;</span><br><span class="line">        houseBuilder.buildBasic();</span><br><span class="line">        houseBuilder.buildWall();</span><br><span class="line">        houseBuilder.buildRoof();</span><br><span class="line">        <span class="keyword">return</span> houseBuilder.buildHouse();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Main2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doClient</span><span class="params">()</span></span>&#123;</span><br><span class="line">        CommonHouse c = <span class="keyword">new</span> CommonHouse();</span><br><span class="line">        SpecialHouse s = <span class="keyword">new</span> SpecialHouse();</span><br><span class="line">        HouseDirector d = <span class="keyword">new</span> HouseDirector(c);</span><br><span class="line">        House house = director.getHouse();</span><br><span class="line">        <span class="comment">//CommonHouse Basic</span></span><br><span class="line">		<span class="comment">//CommonHouse Wall</span></span><br><span class="line">		<span class="comment">//CommonHouse Roof</span></span><br><span class="line">        HouseDirector d = <span class="keyword">new</span> HouseDirector(s);</span><br><span class="line">        House house1 = director.getHouse();</span><br><span class="line">        <span class="comment">//SpecialHouse Basic</span></span><br><span class="line">		<span class="comment">//SpecialHouse Wall</span></span><br><span class="line">		<span class="comment">//SpecialHouse Roof</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>java中的StringBuilder用的就是建造者模式。    </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类似于StirngBuilder里的源码</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> attr1;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> attr2;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> attr3;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyClass</span><span class="params">(Builder builder)</span></span>&#123;</span><br><span class="line">        attr1 = builder.attr1;</span><br><span class="line">        attr2 = builder.attr2;</span><br><span class="line">        attr3 = builder.attr3;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//构建器</span></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> attr1;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> attr2 = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> attr3 = <span class="number">3</span>;</span><br><span class="line">        <span class="comment">//修改属性 返回this</span></span><br><span class="line">        Builder(<span class="keyword">int</span> attr1)&#123;</span><br><span class="line">            <span class="keyword">this</span>.attr1 = attr1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">attr2</span><span class="params">(<span class="keyword">int</span> attr2)</span></span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.attr2 = attr2;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">attr3</span><span class="params">(<span class="keyword">int</span> attr3)</span></span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.attr3 = attr3;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//调用MyClass构造函数传入Builder对象构建 返回MyClass对象</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> MyClass <span class="title">Build</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> MyClass(<span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"attr1:"</span>+attr1+<span class="string">" attr2:"</span>+attr2+<span class="string">" attr3:"</span>+attr3;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyClass obj1 = <span class="keyword">new</span> MyClass.Builder(<span class="number">1</span>).attr2(<span class="number">20</span>).attr3(<span class="number">30</span>).Build();</span><br><span class="line">        System.out.println(obj2);<span class="comment">//attr1:1 attr2:20 attr3:30</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>使用建造者模式的好处：<br>1.使用建造者模式可以使客户端不必知道产品内部组成的细节。<br>2.具体的建造者类之间是相互独立的，对系统的扩展非常有利。<br>3.由于具体的建造者是独立的，因此可以对建造过程逐步细化，而不对其他的模块产生任何影响。<br>使用建造者模式的场合:<br>1.创建一些复杂的对象时，这些对象的内部组成构件间的建造顺序是稳定的，但是对象的内部组成构件面临着复杂的变化。<br>2.要创建的复杂对象的算法，独立于该对象的组成部分，也独立于组成部分的装配方法时。</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">康宁</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://jwkang99.github.io/posts/f9f3b918.html">https://jwkang99.github.io/posts/f9f3b918.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://jwkang99.github.io">解忧杂货铺</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/java/">java    </a><a class="post-meta__tags" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式    </a></div><div class="post_share"><div class="social-share" data-image="/img/设计模式.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/posts/30d88c90.html"><img class="prev_cover lazyload" data-src="/img/剑指offer.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>剑指offer算法答案(java)</span></div></a></div><div class="next-post pull_right"><a href="/posts/41c70678.html"><img class="next_cover lazyload" data-src="/img/设计模式.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>设计模式简单实现(结构型)</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/posts/111e02e0.html" title="volatile关键字"><img class="relatedPosts_cover lazyload"data-src="/img/java.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-07-22</div><div class="relatedPosts_title">volatile关键字</div></div></a></div><div class="relatedPosts_item"><a href="/posts/41c70678.html" title="设计模式简单实现(结构型)"><img class="relatedPosts_cover lazyload"data-src="/img/设计模式.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-11-16</div><div class="relatedPosts_title">设计模式简单实现(结构型)</div></div></a></div><div class="relatedPosts_item"><a href="/posts/74c24778.html" title="设计模式简单实现(行为型)"><img class="relatedPosts_cover lazyload"data-src="/img/设计模式.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-11-16</div><div class="relatedPosts_title">设计模式简单实现(行为型)</div></div></a></div><div class="relatedPosts_item"><a href="/posts/13c7dd67.html" title="Minor/Major/Full GC"><img class="relatedPosts_cover lazyload"data-src="/img/jvm.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-05-16</div><div class="relatedPosts_title">Minor/Major/Full GC</div></div></a></div><div class="relatedPosts_item"><a href="/posts/d51b6e9c.html" title="JVM判断对象是否可回收"><img class="relatedPosts_cover lazyload"data-src="/img/jvm.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-05-16</div><div class="relatedPosts_title">JVM判断对象是否可回收</div></div></a></div><div class="relatedPosts_item"><a href="/posts/b38f68fb.html" title="JVM垃圾收集器"><img class="relatedPosts_cover lazyload"data-src="/img/jvm.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-05-17</div><div class="relatedPosts_title">JVM垃圾收集器</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By 康宁</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>